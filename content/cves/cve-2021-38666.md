---
title: CVE-2021-38666 in Windows â€” Remote Code Execution in the RDP client
slug: cve-2021-38666-microsoft-rdp-client-rce
type:
  - post
  - posts
date: 2021-11-09
weight: 1
description: "In Microsoft Remote Desktop, a malicious RDP server could trigger a remote code execution on a client."
---

* [MSRC Report: Remote Desktop Client Remote Code Execution Vulnerability](https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2021-38666)
* CVSS 8.8 (*Critical*)

## Summary

In Microsoft RDP, a malicious RDP server could remotely execute code in a client through the RDPDR extension (enabled by default).

This affected many versions of Windows, including Windows 11 and 10.

## Details

The vulnerability lied in the smart card extension of the RDPDR virtual channel. A malicious server could ask the client to perform an IOCTL call through a carefully serialized RPC message. During the deserialization process, a misuse of the RPC NDR mashalling engine led to a heap-based buffer overflow.

More details available in a [dedicated article over on Thalium's blog](https://thalium.github.io/blog/posts/deserialization-bug-through-rdp-smart-card-extension/).
